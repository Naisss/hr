@using Entity;
@{
    Layout = null;
}

<!DOCTYPE html>


<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="~/css/cwcalendar.css" rel="stylesheet" />
    <link href="~/css/table.css" rel="stylesheet" />
    <script src="~/javascript/jquery-1.7.2.js"></script>
    <script src="~/javascript/vue.js"></script>
    <script type="text/javascript">
        //var vue=null;

        //$(function () {
        //    vue = new Vue({
        //        el: "#table",
        //        data:{
        //            mun: null,

        //        },
        //        methods: {
        //            load:function () {
        //                var lo = this;
        //                $.ajax({
        //                    url:"/salaryGrant/Check1",
        //                    type:"get",
        //                    data:"",
        //                    success: function (mag) {
        //                        var dt = eval("(" + mag + ")");
        //                        var id = dt["salary_grant_details"];
        //                        for (var i = 0; i < id.length;i++){

        //                            var sid = dt["list" + i];
        //                            lo.$set("mun"+i,sid);

        //                        }
        //                        lo.mun = id;

        //                    }
        //                })

        //            }

        //        }

        //    })
        //    vue.load();

        //})

    </script>
    <title>check</title>
</head>
<body>
    @{List<salary_grant_details> list = ViewBag.s["salary_grant_details"]; }
    @{List<string> sg =ViewBag.ss;}
    <form method="post" action="/salary_grant/UpdateZ">
        <div id="table">
            <table width="100%">
                <tbody>
                    <tr>
                        <td colspan="2" style="text-align: left">
                            <font color="black">
                                您正在做的业务是：人力资源--薪酬标准管理--薪酬发放复核
                            </font>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: right;">
                            <input type="submit" value="提交" class="BUTTON_STYLE1">
                            <input type="button" value="返回" onclick="javascript:window.history.back();" class="BUTTON_STYLE1">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left">
                            薪酬单编号：@list[0].salary_grant_id
                            <input type="hidden" name="salary_grant_id1" value="@list[0].salary_grant_id">
                         
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left">
                            机构：
                            Ⅰ级结构
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left">
                            本机构总人数:<span id="rshu">@list.Count</span>
                            <input type="hidden" name="human_amount" id="size" value="@list.Count">
                            ，基本薪酬总数<span id="span">@ViewBag.Sums</span> :<input type="hidden" name="salary_standard_sum" id="salaryStandardSum" value="@ViewBag.Sums">
                            ，实发总额:<span id="salarySum_sum">@ViewBag.Sum</span>
                            <input type="hidden" id="salaryPaidSum" name="salary_paid_sum" value="@ViewBag.Sums">
                        </td>
                        <td style="text-align: right;">
                            复核人:<input type="text" name="checker" value="better_admin" size="8" readonly="readonly">
                            复核时间：<span id="Tdate">2019-07-03 22:47:51</span>
                            <input type="hidden" name="check_time" id="Tdate2" value="2019-07-03 22:47:51">
                        </td>
                    </tr>
                </tbody>
            </table>
            <table bordercolorlight="#848284" bordercolordark="#eeeeee" class="TABLE_STYLE1" id="table" width="100%" cellspacing="1" cellpadding="0" border="1">


                <tr>
                    <td class="TD_STYLE1">
                        <span>序号</span>
                    </td>
                    <td class="TD_STYLE1">
                        <span>档案编号</span>
                    </td>
                    <td class="TD_STYLE1">
                        <span>姓名</span>
                    </td>
                       <td class="TD_STYLE1">         
                    工资详情
                </td>   
                    @*<td class="TD_STYLE1">
                        出差补助
                    </td>
                    <td class="TD_STYLE1">
                        交通补贴
                    </td>
                    <td class="TD_STYLE1">
                        住房补贴
                    </td>
                    <td class="TD_STYLE1">
                        基本工资
                    </td>
                    <td class="TD_STYLE1">
                        年终奖
                    </td>
                    <td class="TD_STYLE1">
                        误餐补助
                    </td>*@
                    <td class="TD_STYLE1" width="7%">
                        奖励金额
                    </td>
                    <td class="TD_STYLE1" width="7%">
                        销售绩效总额
                    </td>
                    <td class="TD_STYLE1" width="7%">
                        应扣金额
                    </td>
                    <td class="TD_STYLE1" width="7%">
                        实发金额
                    </td>
                </tr>



                @for (int i = 0; i < list.Count; i++)
                {
                    short aa = 0;
                    //var list2 = (Dictionary<String, object>)ViewBag.c;
                    //var keys = list2.Keys;
                    <tr>
                        <input type="hidden" name="grd_id" value="@list[i].grd_id">
                        @*<input type="hidden" name="salary_grant_id" value="@list[i].salary_grant_id">*@
                        <td>@list[i].salary_grant_id</td>
                        <td>@list[i].human_id<input type="hidden" name="grantDetails@{@i}.humanId" value="@list[i].human_id"></td>
                        <td>@list[i].human_name<input type="hidden" name="grantDetails@{@i}.humanName" value="@list[i].human_name"></td>
                        @{List<salary_standard_details> list2 = ViewBag.s["list" + i]; }
                     
                        @*@for (int ii = 0; ii < list2.Count; ii++)
                        {
                            <td>@list2[ii].salary</td>
                        }*@

                                  <td>
                                      <a href='/salary_grant/xq/@sg[i]'>查看薪酬详情</a>
                                  </td>
                       <td>
                            @*奖励金额*@
                    <input type="text" name="grantDetails@{ @(i)}.bounsSum" id="bounsSum@(i)" onkeyup="onKeyPress('@(i)')" class="INPUT_STYLE2" value="@list[i].bouns_sum"     />
                       </td>

                       <td>
                        @*销售绩效总额*@
                    <input type="text" name="grantDetails@{ @(i)}.saleSum" id="saleSum@(i)" onkeyup="onKeyPress('@(i)')" class="INPUT_STYLE2" value="@list[i].sale_sum" />
                    </td>
                    <td>
                        @*银扣金额*@
                    <input type="text" name="grantDetails@{ @(i)}.deductSum" id="deductSum@(i)" onkeyup="onKeyPress('@(i)')" class="INPUT_STYLE2"  value="@list[i].deduct_sum"/>
                    </td>
                    <td>
                        @*实发金额*@
                    <input type="text" name="grantDetails@{ @(i)}.salaryPaidSum" readonly="readonly" id="salaryPaidSum @i" value="@list[i].salary_paid_sum" class="INPUT_STYLE2" />
                        <input type="hidden" value="@list[i].salary_standard_sum" id="salaryStandardSum@{@i}" name="grantDetails@{@i}.salaryStandardSum"/>
                        <input type="hidden"  name="grantDetails@{ @(i)}.salary_standard_sum" value="@list[i].salary_standard_sum">
                        <input type="hidden" name="salary_standard_id@{@i} " value="201906270001">
                        
                    </td>
               
                    </tr>

                    
        aa++;

    }

            </table>

        </div>
    </form>

    <SCRIPT type="text/javascript">

		function onKeyPress(i){
		    //alert(i);
		var size=document.getElementById("size").value;
		var bounsSum=document.getElementById("bounsSum"+i);
		var saleSum =document.getElementById("saleSum"+i);
		var deductSum=document.getElementById("deductSum"+i);
		var salaryPaidSum = document.getElementById("salaryPaidSum " + i);
		
		if (isNaN(bounsSum.value) || bounsSum.value < 0) {
		alert("金额填写错误!");
		bounsSum.value="0.00";
		return;
	}
		if (isNaN(saleSum.value) || saleSum.value < 0) {
		alert("金额填写错误!");
		saleSum.value="0.00";
		return;
	}
		if (isNaN(deductSum.value) || deductSum.value < 0) {
		alert("金额填写错误!");
		deductSum.value="0.00";
		return;
		}
		//alert(bounsSum.value);
		//alert(saleSum.value);
		//alert(deductSum.value);
		//alert(salaryPaidSum.value);
		salaryPaidSum.value=Number(bounsSum.value)+Number(saleSum.value)-Number(deductSum.value)+Number(document.getElementById("salaryStandardSum"+i).value);

		var sum=0;
		for(var j=0;j<size;j++){
		    sum = Number(sum) + Number(document.getElementById("salaryPaidSum "+ j).value);


		}
		       document.getElementById("salarySum_sum").innerHTML = sum;
		       document.getElementById("salaryPaidSum").value = sum;

		}



		function time(){
 					var tdate=document.getElementById("Tdate");
 					var d=new Date();
 					var y=d.getFullYear();
 					var moth=d.getMonth()+1;
 					var date=d.getDate();
 					var h=d.getHours();
 					var m=d.getMinutes();
 					var s=d.getSeconds();
					var hh=20-1-h;
					var mm=60-1-m;
					var ss=60-s;
					if(hh>0){
							mm=mm+60*hh;
					}
 					if(moth<10){
 							moth="0"+moth;
 					}
 					if(date<10){
 							date="0"+date;
 					}
 					if(h<10){
 							h="0"+h;
 					}
 					if(m<10){
 							m="0"+m;
 					}
 					if(s<10){
 							s="0"+s;
 					}
 					if(mm<10){
 							mm="0"+mm;
 					}
 					if(ss<10){
 							ss="0"+ss;
 					}

 					tdate.innerHTML=y+"-"+moth+"-"+date+" "+h+":"+m+":"+s;
					 document.getElementById("Tdate2").value=tdate.innerHTML;
 				}
 				window.onload=time;
 				var out=window.setInterval(time, 1000);
    </SCRIPT>
    <!-- Visual Studio Browser Link -->
    @*<script type="application/json" id="__browserLink_initializationData">
        {"appName":"Firefox","requestId":"596e51e818e9456192be6a4563fe00b1"}
    </script>
    <script type="text/javascript" src="http://localhost:1722/1a2514aeec2f4489861d563f6b8196cb/browserLink" async="async"></script>*@
    <!-- End Browser Link -->

</body>
</html>
