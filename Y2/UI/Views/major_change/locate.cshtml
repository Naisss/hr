@model major_change
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="~/css/table.css" rel="stylesheet" />
    <link href="~/css/calendar-win2k-cold-1.css" rel="stylesheet" />
    <script src="~/javascript/cal.js"></script>
    <script src="~/javascript/comm.js"></script>
    <script src="~/javascript/list.js"></script>
    <script src="~/javascript/jquery-1.7.2.js"></script>
    <script src="~/javascript/calendar-ch.js"></script>

    <script src="~/javascript/comm/time.js"></script>
    <link href="~/css/cwcalendar.css" rel="stylesheet" />
</head>
<body>
    @{
        DataTable first = ViewBag.first;
        //DataTable second = ViewBag.second;
        //DataTable third = ViewBag.third;
        DataTable majorkind = ViewBag.majorkind;
        //DataTable major = ViewBag.major;
    }
    @*<form method="post" action="/major_change/list">*@
        <input type="hidden" name="page.startPage" value="0">
        <table width="100%">
            <tr>
                <td>
                    <font color="black">您正在做的业务是：人力资源--调动管理--调动查询 </font>
                </td>
            </tr>
            <tr>
                <td align="right">
                    <input type="submit" value="查询"
                           class="BUTTON_STYLE1"  id="cx">
                </td>
            </tr>
        </table>
        <table width="100%" border="1" cellpadding=0 cellspacing=1
               bordercolorlight=#848284 bordercolordark=#eeeeee
               class="TABLE_STYLE1">
            <tr class="TR_STYLE1">
                <td width="16%" class="TD_STYLE1">
                    请选择员工所在I级机构
                </td>
                <td width="84%" class="TD_STYLE2">
                    <script type="text/javascript">
			$(function() {
			var first=$("#firstKindId");
			var second = $("#secondKindId");
			var third=$("#thirdKindId");
	 		first.change(function(){
			    $.ajax({
			        url: "/major_change/FindTwo/null?firstid=" + $('#firstKindId option:selected').val(),
			        type: "post",
			        success: function (data) {
			        var data = eval("(" + data + ")");
			        second.css("width", first.width());
			        second.empty();
			        second.append("<option value='0' selected='selected'>全部</option>");
			        for (var i = 0;i<data.length;i++){
			            second.append("<option value='" + data[i]["second_kind_id"] + "'>" + data[i]["second_kind_name"] + "</option>");
			        } 
			        }
			    });
	 		 	if (first.val() == '0') {
	 		 	third.empty();
	 		 	third.append("<option value='0'selected='selected'>全部</option>");
	 		 	second.append("<option value='0'selected='selected'>全部</option>");
	 		 	second.css("width",first.width());
	 		 	third.css("width",second.width());
	 		 	}
	 		 }); });
                    </script>
                    <select name="new_first_kind_id" id="firstKindId" size="5" class="SELECT_STYLE2">
                       <option value="0" selected="selected">全部</option>
                       @foreach (DataRow dr in first.Rows)
                       {
                       <option value=@dr["first_kind_id"]>@dr["first_kind_name"]</option>
                       }         
                    </select>
                </td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    请选择员工所在II级机构
                </td>
                <td width="84%" class="TD_STYLE2">
                    <script type="text/javascript">
			$(function() {
			var first=$("#firstKindId");
			var second= $("#secondKindId");
			var third = $("#thirdKindId");
			var mkd = $("#newMajorKindId");
	 	    second.change(function(){
	 	        $.ajax({
	 	            url: "/major_change/FindThree/null?secondid=" + $('#secondKindId option:selected').val() + "&&firstid=" + $('#firstKindId option:selected').val(),
	 	            type: "post",
	 	            success: function (data) {
	 	                var data = eval("(" + data + ")");
	 	                second.css("width", first.width());
	 	                third.empty();
	 	                third.append("<option value='0' selected='selected'>全部</option>");
	 	                for (var i = 0; i < data.length; i++) {
	 	                    third.append("<option value='" + data[i]["third_kind_id"] + "'>" + data[i]["third_kind_name"] + "</option>");
	 	                }
	 	            }
	 	        });
	 	        if(second.val()=='0'){
	 	            third.empty();
	 	            third.append("<option value='0'selected='selected'>全部</option>");
	 	            third.css("width", second.width());
	 	        }
	 	    })
	 	    third.change(function () {
	 	        $.ajax({
	 	            url: "/major_change/FindMajor",
	 	            type: "post",
	 	            success: function (data) {
	 	                var data = eval("(" + data + ")");
	 	                mkd.css("width", first.width());
	 	                mkd.empty();
	 	                mkd.append("<option value='0' selected='selected'>全部</option>");
	 	                for (var i = 0; i < data.length; i++) {
	 	                    mkd.append("<option value='" + data[i]["major_kind_id"] + "'>" + data[i]["major_kind_name"] + "</option>");
	 	                }
	 	            }
	 	        });
	 	        if (third.val() == '0') {
	 	            mkd.empty();
	 	            mkd.append("<option value='0' selected='selected'>全部</option>");
	 	            mkd.css("width",first.width());
	 	        }
	 	    });
		   });
                    </script>
                    <select name="new_second_kind_id" id="secondKindId" size="5" class="SELECT_STYLE2">
                        @*<option value="0" selected="selected">全部</option>*@
                        @*@foreach (DataRow dr in second.Rows)
                        {
                            <option value=@dr["new_second_kind_id"]>@dr["new_second_kind_name"]</option>
                        }*@         
                    </select>
                </td>
            </tr>
            <tr class="TR_STYLE1">
                <td width="16%" class="TD_STYLE1">
                    请选择员工所在III级机构
                </td>
                <td width="84%" class="TD_STYLE2">
                    <select name="new_third_kind_id" id="thirdKindId" size="5" class="SELECT_STYLE2">
                        @*<option value="0" selected="selected">全部</option>
                        @foreach (DataRow dr in third.Rows)
                        {
                            <option value=@dr["new_third_kind_id"]>@dr["new_third_kind_name"]</option>
                        }*@        
                    </select>
                </td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    请选择职位分类
                </td>
                <td width="84%" class="TD_STYLE2">
                    <select name="new_major_kind_id" id="newMajorKindId" size="5" class="SELECT_STYLE2">
                        @*<option value="0" selected="selected">全部</option>
                        @foreach (DataRow dr in majorkind.Rows)
                        {
                            <option value=@dr["major_kind_id"]>@dr["major_kind_name"]</option>
                        }*@       
                    </select>
                    <script type="text/javascript">
                        $(function () {
                            var first=$("#firstKindId");
			                var second= $("#secondKindId");
			                var third=$("#thirdKindId");
                            var mkid = $('#newMajorKindId');
                            var mid = $("#zhiwei");
                            mkid.change(function(){
                                $.ajax({
                                    url: "/major_change/FindMid/null?mkid=" + $('#newMajorKindId option:selected').val(),
                                    type: "post",
                                    success: (function (data) {
                                        var dt = eval("(" + data + ")");
                                        mid.css("width", first.width());
                                        mid.empty();
                                        mid.append("<option value='0' selected='selected'>全部</option>");
                                        for (var i = 0; i < dt.length;i++) {
                                            mid.append("<option value='" + dt[i]["major_id"] + "'>" + dt[i]["major_name"] + "</option>");
                                        }
                                    })
                                 })
                            })       
                         })
                     </script>
                </td>
            </tr>
            <tr class="TR_STYLE1">
                <td width="16%" class="TD_STYLE1">
                    请选择职位名称
                </td>
                <td width="84%" class="TD_STYLE2">
                    <select name="new_major_id" size=5 id="zhiwei" class="SELECT_STYLE2">
                        @*<option value="0" selected="selected">全部</option>
                        @foreach (DataRow dr in major.Rows)
                        {
                            <option value=@dr["new_major_id"]>@dr["new_major_name"]</option>
                        }*@                             
                    </select>
                </td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    请输入建档时间
                </td>
                <td width="84%" class="TD_STYLE2">
                    <input name="startDate" onclick="aa('startDate')" type="text" class="INPUT_STYLE2" id="date_start" style="width:24% " value="" size="30">
                    至<input type="text" name="endDate" onclick="aa('endDate')" value="" style="width:24% " class="INPUT_STYLE2" id="date_end">
                   （YYYY-MM-DD）
                </td>
            </tr>
        </table>
     <script>
         $(function () {
             $("#cx").click(function () {
                 var startDate = $("#date_start").val();
                 var endDate = $("#date_end").val();
                 alert($("#zhiwei").val());
                 $.ajax({
                     url: '/major_change/Show',
                     type:'post',
                     data: "",
                     success: function (msg) {
                         if(msg=="ok"){
                             window.location.href = "/major_change/list/?startDate=" + startDate + "&endDate=" + endDate + "&fid=" + $("#firstKindId").val() + "&sid=" + $("#secondKindId").val() + "&tid=" + $("#thirdKindId").val() + "&mkid=" + $('#newMajorKindId').val() + "&mid=" + $("#zhiwei").val();
                         }
                     }
                 })
             });
         });
    </script>
    @*</form>*@
</body>
</html>

